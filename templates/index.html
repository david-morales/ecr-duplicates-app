<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Occurrence Data Management</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Moment JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables.net -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>

    <!-- DataTables Column Visibility Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js"></script>

    <!-- DataTables SearchBuilder Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/searchbuilder/1.4.0/css/searchBuilder.dataTables.min.css">
    <script src="https://cdn.datatables.net/searchbuilder/1.4.0/js/dataTables.searchBuilder.min.js"></script>

    <!-- DataTables FixedColumns Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/4.3.0/css/fixedColumns.dataTables.min.css">
    <script src="https://cdn.datatables.net/fixedcolumns/4.3.0/js/dataTables.fixedColumns.min.js"></script>

    <!-- DataTables Fullscreen Button Extension -->
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.fullscreen.min.js"></script>

    <!-- DataTables SearchPanes Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.dataTables.min.css">
    <script src="https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>

    <!-- DataTables Export Buttons -->
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>


    <!-- DataTables FixedHeader Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.4.0/css/fixedHeader.dataTables.min.css">
    <script src="https://cdn.datatables.net/fixedheader/3.4.0/js/dataTables.fixedHeader.min.js"></script>


    <!-- Custom Styles and Scripts -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}?v=1.0">
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
</head>

<body>
    <!-- EASA Header Section -->
    <header class="easa-header">
        <div class="easa-header-top">
            <!-- EASA Logo -->
            <img src="{{ url_for('static', filename='images/easa_logo.png') }}" alt="EASA" class="easa-logo">

            <!-- Launcher Menu -->
            <div class="launcher">
                <div class="button">
                    <i class="fa fa-th fa-2x"></i>
                </div>
                <div class="app-launcher">
                    <div class="apps">
                        <ul class="first-set">
                            <li><a href="#"><i class="fa fa-google-plus-square fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-facebook-square fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-twitter-square fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-youtube-square fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-skype fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-windows fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-linkedin fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-apple fa-4x"></i></a></li>
                            <li><a href="#"><i class="fa fa-android fa-4x"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>


        <div class="easa-header-bottom d-flex justify-content-between align-items-center">
            <h1 class="system-title">Safety Occurrences - Data Management System</h1>
            <h1 id="user-greeting">ðŸ‘‹ Hello, {{ user_email }}!</h1>
        </div>
    </header>



    <div class="container mt-5">

        <h2 class="text-center">ECR Occurrences - Duplicates Management

            <button class="btn btn-info ms-3" type="button" data-bs-toggle="collapse" data-bs-target="#helpDescription" aria-expanded="false" aria-controls="helpDescription">
                Need Help?
            </button>
        </h2>

        <div class="collapse mt-2" id="helpDescription">
            <div class="card card-body post-it-note">
                <p>This tool allows you to manage and review duplicate occurrences within the ECR database. You can filter, sort, and exclude duplicate records to ensure data integrity.</p>
                <ul>
                    <li><strong>Occurrences Tab:</strong> Review and submit occurrences for processing.</li>
                    <li><strong>Audit Logs:</strong> Track all actions performed on records.</li>
                    <li><strong>Excluded Records:</strong> Manage records that have been marked as duplicates.</li>
                </ul>
            </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs mt-4" id="dataTabs" role="tablist">
            <li class="nav-item">
                <button class="nav-link active" id="occurrences-tab" data-bs-toggle="tab" data-bs-target="#occurrences">Occurrences</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="audit-tab" data-bs-toggle="tab" data-bs-target="#audit">Audit Logs</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="excluded-tab" data-bs-toggle="tab" data-bs-target="#excluded">Excluded Records</button>
            </li>
        </ul>


        <div class="tab-content mt-4">

            <!-- Toast Notification Container -->
            <div id="toast-container" class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
                <div id="toastMessage" class="toast align-items-center text-white bg-primary border-0" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="d-flex">
                        <div class="toast-body" id="toastMessageContent">
                            <!-- Message will be injected dynamically -->
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                </div>
            </div>


            <!-- Occurrences Table -->
            <div class="tab-pane fade show active" id="occurrences">
                <div id="occurrence_submit" class="occurrence-controls mb-3 text-end">
                    <button id="submit-ocurrences" class="btn btn-primary">Submit Selected Occurrences</button>
                </div>
                <table id="occurrence_table" class="display nowrap" style="width:100%">
                    <thead>
                        <tr>
                            <th>Comments</th>
                            <th>E2 Occurrence ID</th>
                            <th>File Number</th>
                            <th>UTC Date</th>
                            <th>Local Date</th>
                            <th>State Area of Occurrence</th>
                            <th>Location</th>
                            <th>Occurrence Class</th>
                            <th>Injury Level</th>
                            <th>Highest Damage</th>
                            <th>Occurrence Category</th>
                            <th>Aircraft Registration</th>
                            <th>State of Registry</th>
                            <th>Operator State</th>
                            <th>Operation Type Level 1</th>
                            <th>Operation Type Level 2</th>
                            <th>Operation Type Level 3</th>
                            <th>Operator Name</th>
                            <th>Aircraft Category Level 1</th>
                            <th>Aircraft Category Level 2</th>
                            <th>Aircraft Category Level 3</th>
                            <th>Aircraft Category Level 4</th>
                            <th>Manufacturer Model Level 1</th>
                            <th>Manufacturer Model Level 2</th>
                            <th>Annex I Aircraft</th>
                            <th>Mass Group L1</th>
                            <th>Mass Group L2</th>
                            <th>Propulsion Type</th>
                            <th>Flight Phase</th>
                            <th>Total Number of Fatalities (Aircraft)</th>
                            <th>Total Number of Serious Injuries (Aircraft)</th>
                            <th>Total Number of Fatalities (Ground)</th>
                            <th>Total Number of Serious Injuries (Ground)</th>
                            <th>Headline</th>
                            <th>Consolidated Date</th>
                            <th>Year</th>
                            <th>Consolidated Occurrence Class</th>
                            <th>CS 27 CS 29</th>
                            <th>Annex I Rotorcraft</th>
                            <th>Foreign Operator Aircraft</th>
                            <th>Rotorcraft Safety Roadmap SPI</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <!-- Audit Logs Table -->
            <div class="tab-pane fade" id="audit">
                <table id="audit_table" class="display nowrap" style="width:100%">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Time</th>
                            <th>Action</th>
                            <th>Selected IDs</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <!-- Excluded Records Table -->
            <div class="tab-pane fade" id="excluded">
                <div id="excluded_submit" class="excluded-controls mb-3 text-end">
                    <button id="remove-selected" class="btn btn-danger">Remove Selected Excluded Records</button>
                </div>
                <table id="excluded_table" class="display nowrap" style="width:100%">
                    <thead>
                        <tr>
                            <th>Comments</th>
                            <th>E2 Occurrence ID</th>
                            <th>File Number</th>
                            <th>UTC Date</th>
                            <th>Local Date</th>
                            <th>State Area of Occurrence</th>
                            <th>Location</th>
                            <th>Occurrence Class</th>
                            <th>Injury Level</th>
                            <th>Highest Damage</th>
                            <th>Occurrence Category</th>
                            <th>Aircraft Registration</th>
                            <th>State of Registry</th>
                            <th>Operator State</th>
                            <th>Operation Type Level 1</th>
                            <th>Operation Type Level 2</th>
                            <th>Operation Type Level 3</th>
                            <th>Operator Name</th>
                            <th>Aircraft Category Level 1</th>
                            <th>Aircraft Category Level 2</th>
                            <th>Aircraft Category Level 3</th>
                            <th>Aircraft Category Level 4</th>
                            <th>Manufacturer Model Level 1</th>
                            <th>Manufacturer Model Level 2</th>
                            <th>Annex I Aircraft</th>
                            <th>Mass Group L1</th>
                            <th>Mass Group L2</th>
                            <th>Propulsion Type</th>
                            <th>Flight Phase</th>
                            <th>Total Number of Fatalities (Aircraft)</th>
                            <th>Total Number of Serious Injuries (Aircraft)</th>
                            <th>Total Number of Fatalities (Ground)</th>
                            <th>Total Number of Serious Injuries (Ground)</th>
                            <th>Headline</th>
                            <th>Consolidated Date</th>
                            <th>Year</th>
                            <th>Consolidated Occurrence Class</th>
                            <th>CS 27 CS 29</th>
                            <th>Annex I Rotorcraft</th>
                            <th>Foreign Operator Aircraft</th>
                            <th>Rotorcraft Safety Roadmap SPI</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <br>
    <br>
    <br>
    <br>
</body>

</html>
